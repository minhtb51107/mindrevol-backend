spring.application.name=mindrevol-backend

# Mặc định chạy profile dev nếu không chỉ định gì khác
spring.profiles.active=dev

# --- 1. SYSTEM ARCHITECTURE (Kiến trúc hệ thống) ---
# Tắt Open-in-view để tránh lỗi transaction ngầm
spring.jpa.open-in-view=false
# Sử dụng PostgreSQL Dialect
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
# Liquibase luôn chạy để quản lý DB (Source of Truth)
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.xml
spring.liquibase.enabled=true
# Hibernate chỉ được phép VALIDATE, không được tự ý sửa DB (đã có Liquibase lo)
spring.jpa.hibernate.ddl-auto=validate

# --- 2. AUTHENTICATION & SECURITY (Khung sườn) ---
app.security.max-concurrent-sessions=5
# JWT Config (Giá trị thực sẽ được override hoặc lấy từ ENV)
app.jwt.access-token-expiration-ms=3600000
app.jwt.refresh-token-expiration-ms=86400000
# Giá trị mặc định là biến môi trường (cho Production)
app.jwt.secret=${APP_JWT_SECRET}

# --- 3. OAUTH2 (Google / Apple) ---
# Google
spring.security.oauth2.client.registration.google.client-name=Google
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/oauth2/callback/google
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.provider.google.authorization-uri=https://accounts.google.com/o/oauth2/v2/auth
spring.security.oauth2.client.provider.google.token-uri=https://oauth2.googleapis.com/token
spring.security.oauth2.client.provider.google.user-info-uri=https://www.googleapis.com/oauth2/v3/userinfo
spring.security.oauth2.client.provider.google.user-name-attribute=sub
# Apple
spring.security.oauth2.client.registration.apple.client-id=com.mindrevol.app

# --- 4. EMAIL SERVICE ---
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${SPRING_MAIL_USERNAME}
spring.mail.password=${SPRING_MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# --- 5. LOGGING FORMAT (Định dạng log đẹp) ---
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] [%X{requestId}] %-5level %logger{36} - %msg%n

# --- 6. CLOUDINARY (Cấu hình ảnh) ---
cloudinary.cloud-name=${CLOUDINARY_CLOUD_NAME}
cloudinary.api-key=${CLOUDINARY_API_KEY}
cloudinary.api-secret=${CLOUDINARY_API_SECRET}

# --- ACTUATOR & MONITORING ---
# Bật các endpoint cần thiết (health: kiểm tra sống/chết, prometheus: số liệu metrics)
management.endpoints.web.exposure.include=health,info,prometheus

# Hiển thị chi tiết health (ví dụ: DB down hay Redis down)
management.endpoint.health.show-details=always

# Thêm tags cho metrics (để biết metrics này của app nào, môi trường nào)
management.metrics.tags.application=${spring.application.name}
management.metrics.tags.env=${spring.profiles.active}

# MinIO Configuration
minio.url=http://localhost:9000
minio.access-key=mindrevol_admin
minio.secret-key=mindrevol_password
minio.bucket-name=mindrevol-media

# 1. Rate Limiting
app.ratelimit.login.limit=5
app.ratelimit.login.duration-min=1
app.ratelimit.general.limit=100
app.ratelimit.general.duration-min=1
app.ratelimit.strict.limit=10
app.ratelimit.strict.duration-hour=1

# 2. Gamification Rules
app.gamification.points.checkin-normal=10
app.gamification.points.checkin-comeback=100
app.gamification.points.item-freeze-cost=500

# 3. Cache TTL
app.cache.ttl-minutes=10

# Firebase Config (Đọc từ biến môi trường đã inject)
firebase.credentials.base64=${FIREBASE_CREDENTIALS_BASE64}